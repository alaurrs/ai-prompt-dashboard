<div class="lp-container">
  <!-- Profile header -->
  @if (user()) {
    <div class="profile">
      <p-avatar [image]="user()?.avatarUrl" [icon]="!user()?.avatarUrl ? 'pi pi-user' : undefined" [class]="'avatar'" shape="circle"></p-avatar>
      <div class="profile-meta">
        <div class="name" title="{{ user()?.name }}">{{ user()?.name }}</div>
        <div class="email" title="{{ user()?.email }}">{{ user()?.email }}</div>
      </div>
    </div>
  }


  <!-- Search -->
  <div class="search relative">
    <i class="pi pi-search search-icon pointer-events-none" aria-hidden="true"></i>
    <input
      pInputText
      type="text"
      class="input w-full h-10 pl-10 pr-3 rounded-full border bg-color:var(--surface) border-color:var(--border) text-color:var(--text) placeholder:text-color:var(--muted) focus:outline-none focus:ring-2 focus:ring-color:var(--primary)/30"
      [ngModel]="query"
      (input)="onSearchEvent($event)"
      placeholder="Search conversations..."
      aria-label="Search conversations"/>
  </div>

  <!-- Primary nav -->
  <nav class="primary-nav">
    @for (it of nav; track it.key) {
      <button type="button" class="nav-item rounded-full" [class.active]="it.active" (click)="onNav(it)">
        <i class="pi {{ it.icon }} nav-icon" aria-hidden="true"></i>
        <span class="label">{{ it.label }}</span>
      </button>
    }
  </nav>

  <!-- CTA -->
  <div class="cta">
    <button type="button"
            (click)="newChat.emit()"
            class="btn btn-primary w-full rounded-full h-11 px-4 text-center focus:outline-none focus:ring-2 focus:ring-color:var(--primary)/30">
      New Chat
    </button>
  </div>

  <!-- Thread list -->
  <div class="threads">
    @for (t of threads; track t.id) {
      <button type="button" class="thread-item" [class.active]="t.id === selectedThreadId" (click)="onOpenThread(t.id)">
        <span class="msg-icon" [class.unread]="t.unread">
          <i class="pi pi-comments" aria-hidden="true"></i>
        </span>

        <div class="texts">
          <div class="row">
            <div class="title" title="{{ t.title }}">{{ t.title }}</div>
            <div class="time" *ngIf="t.updatedAt as ts">{{ ts | date: 'shortTime' }}</div>
          </div>
          <div class="snippet" title="{{ t.snippet }}">{{ t.snippet }}</div>
        </div>
      </button>
    } @empty {
      <div class="muted">No conversations yet.</div>
    }
  </div>
</div>
